<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  <title>Judge Evaluation Form</title>
  <meta name="description" content="Judge Eval Form page 2">
  <meta name="author" content="Group 1">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="formstyle.css">

  </head>

  <body>
  <div id="main">
    <h1>Senior Design Conference Judge Evaluation Form</h1>
    <hr/>

        <table class="basictable">
      <tr>
        <td class="leftcol">Judge ID: </td>
        <td class="rightcol" id= "jID"> </td>
      </tr>
      <tr>
        <td class="leftcol">Judge Name:</td>
        <td class="rightcol" id="jName"></td>
      </tr>
      <tr>
        <td class="leftcol">Session:</td>
        <td class="rightcol" id="session"></td>
      </tr>
      <tr>
        <td class="leftcol">Room:</td>
        <td class="rightcol" id="room"></td>
      </tr>
</table>


    <form action="form3.html">
      Project Title: <!-- <input list="projects" autocomplete="off" name="project"> -->
      <br>
      <select id="projects" name="project" autocomplete="off">
<!--         <option value="val1">
        <option value="val2">
          <option value="val3"> -->
          </select>
          <input type="hidden" id= "jIDhidden" name="judgeId" >
          <input type="hidden" id="jNamehidden" name="judgeName" >
          <input type="hidden" id= "sessionhidden" name="session" >
          <input type="hidden" id="roomhidden" name="room" >
          <input type="submit" value="Submit">
        </form>
  </div>
        <script src="geturl.js"></script>

        <script>

          var jID = getUrlVars()["judgeId"];
          var jName = getUrlVars()["judgeName"];


          document.getElementById('jID').innerHTML= jID;
          document.getElementById('jName').innerHTML= noplus(jName);



          var splitID= jID.split("-");
          var department= splitID[0];
          var session= splitID[1];
          var judge= splitID[2];


          document.getElementById('jIDhidden').value=  judge;
          document.getElementById('jNamehidden').value= noplus(jName);

          var deplist=['COEN', 'MECH', 'CIVIL', 'BIO', 'ELEN', 'INTER', 'WEB'] ;    

          document.getElementById('session').innerHTML= deplist[department] + " " + session;

          $.ajax({
            type:'GET',
            url:'getPres.php',
            data:{department: deplist[department], session: session},
            dataType:'json',
            success: function(response){
              console.log(response)
              document.getElementById('room').innerHTML= response[0].roomNum;
              document.getElementById('projects').innerHTML=populateList(response);
              document.getElementById('sessionhidden').value= deplist[department] + "-" + session;
              document.getElementById('roomhidden').value= response[0].roomNum;
            }
          });

      // document.getElementById('projects').innerHTML=populateList(["hello","hello"]);

      function populateList(list){
        var option="";
        $.each(list, function(index, element) {
          var proj= element.pTitle +"-"+ element.PID;
          var line=["<option value=\"", proj, "\">",proj,"</option>"].join(" ");
          option=option.concat(line, "\n");
        })
        return option;
      }

    </script>
  </body>
  </html>