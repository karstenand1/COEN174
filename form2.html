<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  <title>Judge Evaluation Form</title>
  <meta name="description" content="Judge Eval Form page 2">
  <meta name="author" content="Group 1">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="formstyle.css">

  </head>

  <body>
    <div id="topbar">
      <h1>Select Presentation</h1>
    </div>
    <div id="main">

      <table  class=" nobordertable displaydata">
        <tr>
          <td class="leftcol">Judge Number: </td>
          <td class="rightcol" id= "jID"> </td>

          <td class="leftcol">Session:</td>
          <td class="rightcol" id="session"></td>
        </tr>
        <tr>
          <td class="leftcol">Judge Name:</td>
          <td class="rightcol" id="jName"></td>

          <td class="leftcol">Room:</td>
          <td class="rightcol" id="room"></td>

        </tr>
      </table>


      <form action="form3.html">
       <span class="bold"> Select Presentation:</span> <!-- <input list="projects" autocomplete="off" name="project"> -->
       <select required id="projects" name="project" autocomplete="off">
<!--         <option value="val1">
        <option value="val2">
          <option value="val3"> -->
          </select>
          <input type="hidden" id= "jIDhidden" name="judgeId" >
          <input type="hidden" id="jNamehidden" name="judgeName" >
          <input type="hidden" id= "sessionhidden" name="session" >
          <input type="hidden" id="roomhidden" name="room" >
          <br/>
          <input type="submit" value="Continue to Form">
        </form>
      </div>
      <script src="geturl.js"></script>

      <script>

        var jID = getUrlVars()["judgeId"].toUpperCase();
        var jName = getUrlVars()["judgeName"];


        var idInfo= translateJudgeId(jID);
        console.log(idInfo)
        var department= idInfo[0];
        var session= idInfo[1];
        var judge= idInfo[2];


        document.getElementById('jID').innerHTML= judge;
        document.getElementById('jName').innerHTML= noplus(jName);


        document.getElementById('jIDhidden').value=  judge;
        document.getElementById('jNamehidden').value= noplus(jName);

        deplist=['COEN','MECH','CIVIL','BIO','ELEN','INTER','WEB'];

        function translateJudgeId(judgeid){
           var depdict={
            'F3':'COEN',
            'H6':'MECH',
            'M7':'CIVIL',
            'P9':'BIO',
            'B1':'ELEN', 
            'L2':'INTER',
            'U6':'WEB'}  ;    
          
          var sessionlist={
            'P1': 1,
            'Y8': 2,
            'M2': 3,
            'V1': 4,
            'W4': 5,
            'K6': 6,
            'U7': 7 };

           var judgelist={
            'H3': 1,
            'R8': 2,
            'G2': 3,
            'Y1': 4,
            'X4': 5,
            'Z6': 6,
            'L7': 7 };

            var depstr=judgeid.substring(0,2);
            var seshstr=judgeid.substring(2,4);
            var judgestr=judgeid.substring(4,6);

            var dep= depdict[depstr];
            var session=sessionlist[seshstr];
            var judge=judgelist[judgestr];
            console.log(dep, session,judge)
            return [dep,session,judge];
        }



        document.getElementById('session').innerHTML= department + " " + session;

        $.ajax({
          type:'GET',
          url:'getPres.php',
          data:{department:department, session: session},
          dataType:'json',
          success: function(response){
            console.log(response)
            document.getElementById('room').innerHTML= response[0].roomNum;
            document.getElementById('projects').innerHTML=populateList(response);
            document.getElementById('sessionhidden').value= department + "-" + session;
            document.getElementById('roomhidden').value= response[0].roomNum;
          }
        });

      // document.getElementById('projects').innerHTML=populateList(["hello","hello"]);

      function populateList(list){
        var option="";
        $.each(list, function(index, element) {
          var proj= element.pTitle +"-"+ element.PID;
          var line=["<option value=\"", proj, "\">",proj,"</option>"].join(" ");
          option=option.concat(line, "\n");
        })
        return option;
      }

    </script>
  </body>
  </html>